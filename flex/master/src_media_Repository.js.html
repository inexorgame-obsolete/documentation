

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: src/media/Repository.js | Inexor Flex</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="width: 120px; height: 80px">
        
            <img src="https://raw.githubusercontent.com/inexorgame/artwork/master/logo/logo_rendered.png" width="100%" height="100%">
        
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">Inexor Flex</a></h1>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
    <div class="lnb-api hidden"><h3>Modules</h3><ul><li><a href="module-api.html">api</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:api_sub"></div></li><li><a href="module-console.html">console</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:console_sub"></div></li><li><a href="module-context.html">context</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:context_sub"></div></li><li><a href="module-entities.html">entities</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:entities_sub"></div></li><li><a href="module-gameclient.html">gameclient</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:gameclient_sub"></div></li><li><a href="module-gameserver.html">gameserver</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:gameserver_sub"></div></li><li><a href="module-instances.html">instances</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:instances_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-instances.html#~default_instance_ports">default_instance_ports</a></li><li><a href="module-instances.html#~default_instance_state">default_instance_state</a></li><li><a href="module-instances.html#~default_instance_type">default_instance_type</a></li><li><a href="module-instances.html#~instance_states">instance_states</a></li><li><a href="module-instances.html#~instance_transitions">instance_transitions</a></li><li><a href="module-instances.html#~instance_types">instance_types</a></li></ul></div></li><li><a href="module-interfaces.html">interfaces</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:interfaces_sub"></div></li><li><a href="module-logger.html">logger</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:logger_sub"></div></li><li><a href="module-logging.html">logging</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:logging_sub"></div></li><li><a href="module-media.html">media</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:media_sub"></div></li><li><a href="module-path.html">path</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:path_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-path.html#~config_path">config_path</a></li><li><a href="module-path.html#~DEFAULT_PORT">DEFAULT_PORT</a></li><li><a href="module-path.html#~flex_path">flex_path</a></li><li><a href="module-path.html#~interfaces_path">interfaces_path</a></li><li><a href="module-path.html#~media_path">media_path</a></li><li><a href="module-path.html#~pid_path">pid_path</a></li><li><a href="module-path.html#~releases_path">releases_path</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-path.html#~getConfigPaths">getConfigPaths</a></li><li><a href="module-path.html#~getMediaPaths">getMediaPaths</a></li><li><a href="module-path.html#~getXdgLocationFromEnvironmentVariable">getXdgLocationFromEnvironmentVariable</a></li></ul></div></li><li><a href="module-profiles.html">profiles</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:profiles_sub"></div></li><li><a href="module-releases.html">releases</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:releases_sub"></div></li><li><a href="module-tree.html">tree</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:tree_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-tree.html#~isValidDataType">isValidDataType</a></li><li><a href="module-tree.html#~separator">separator</a></li><li><a href="module-tree.html#~validName">validName</a></li></ul><div class="member-type">Typedef</div><ul class="inner"><li><a href="module-tree.html#~datatype">datatype</a></li><li><a href="module-tree.html#~Flex">Flex</a></li></ul></div></li><li><a href="module-treeclient.html">treeclient</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:treeclient_sub"></div></li><li><a href="module-types.html">types</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:types_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-types.html#~getDataType">getDataType</a></li><li><a href="module-types.html#~isInt">isInt</a></li></ul></div></li></ul></div><div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="FlexArgs.html">FlexArgs</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="FlexArgs_sub"></div></li><li><a href="module-api-ConsoleWsAPI.html">ConsoleWsAPI</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:api~ConsoleWsAPI_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-api-ConsoleWsAPI.html#handleRequest">handleRequest</a></li><li><a href="module-api-ConsoleWsAPI.html#setDependencies">setDependencies</a></li></ul></div></li><li><a href="module-api-FlexRestAPI.html">FlexRestAPI</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:api~FlexRestAPI_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-api-FlexRestAPI.html#getSysInfo">getSysInfo</a></li><li><a href="module-api-FlexRestAPI.html#shutdown">shutdown</a></li><li><a href="module-api-FlexRestAPI.html#version">version</a></li></ul></div></li><li><a href="module-api-InexorTreeRestAPI.html">InexorTreeRestAPI</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:api~InexorTreeRestAPI_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-api-InexorTreeRestAPI.html#convert">convert</a></li><li><a href="module-api-InexorTreeRestAPI.html#dumpInstanceTree">dumpInstanceTree</a></li><li><a href="module-api-InexorTreeRestAPI.html#dumpRootTree">dumpRootTree</a></li><li><a href="module-api-InexorTreeRestAPI.html#dumpSubTree">dumpSubTree</a></li><li><a href="module-api-InexorTreeRestAPI.html#getInstanceNode">getInstanceNode</a></li><li><a href="module-api-InexorTreeRestAPI.html#getRootNode">getRootNode</a></li><li><a href="module-api-InexorTreeRestAPI.html#setInstanceNode">setInstanceNode</a></li><li><a href="module-api-InexorTreeRestAPI.html#setRootNode">setRootNode</a></li></ul></div></li><li><a href="module-api-InexorTreeWsAPI.html">InexorTreeWsAPI</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:api~InexorTreeWsAPI_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-api-InexorTreeWsAPI.html#addNode">addNode</a></li><li><a href="module-api-InexorTreeWsAPI.html#convert">convert</a></li><li><a href="module-api-InexorTreeWsAPI.html#handleRequest">handleRequest</a></li><li><a href="module-api-InexorTreeWsAPI.html#setDependencies">setDependencies</a></li><li><a href="module-api-InexorTreeWsAPI.html#syncNode">syncNode</a></li></ul></div></li><li><a href="module-api-InstancesRestAPI.html">InstancesRestAPI</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:api~InstancesRestAPI_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-api-InstancesRestAPI.html#afterPropertiesSet">afterPropertiesSet</a></li><li><a href="module-api-InstancesRestAPI.html#connectToInstance">connectToInstance</a></li><li><a href="module-api-InstancesRestAPI.html#createInstance">createInstance</a></li><li><a href="module-api-InstancesRestAPI.html#disconnectFromInstance">disconnectFromInstance</a></li><li><a href="module-api-InstancesRestAPI.html#getInstance">getInstance</a></li><li><a href="module-api-InstancesRestAPI.html#listInstances">listInstances</a></li><li><a href="module-api-InstancesRestAPI.html#removeInstance">removeInstance</a></li><li><a href="module-api-InstancesRestAPI.html#setDependencies">setDependencies</a></li><li><a href="module-api-InstancesRestAPI.html#startAllInstances">startAllInstances</a></li><li><a href="module-api-InstancesRestAPI.html#startInstance">startInstance</a></li><li><a href="module-api-InstancesRestAPI.html#stopAllInstances">stopAllInstances</a></li><li><a href="module-api-InstancesRestAPI.html#stopInstance">stopInstance</a></li><li><a href="module-api-InstancesRestAPI.html#synchronizeWithInstance">synchronizeWithInstance</a></li></ul></div></li><li><a href="module-api-MediaRepositoryRestAPI.html">MediaRepositoryRestAPI</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:api~MediaRepositoryRestAPI_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-api-MediaRepositoryRestAPI.html#createMediaRepository">createMediaRepository</a></li><li><a href="module-api-MediaRepositoryRestAPI.html#removeMediaRepository">removeMediaRepository</a></li><li><a href="module-api-MediaRepositoryRestAPI.html#scanMediaRepositories">scanMediaRepositories</a></li><li><a href="module-api-MediaRepositoryRestAPI.html#updateMediaRepository">updateMediaRepository</a></li><li><a href="module-api-MediaRepositoryRestAPI.html#updateMediaRepositoryBranch">updateMediaRepositoryBranch</a></li></ul></div></li><li><a href="module-api-ProfilesRestAPI.html">ProfilesRestAPI</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:api~ProfilesRestAPI_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-api-ProfilesRestAPI.html#createProfile">createProfile</a></li><li><a href="module-api-ProfilesRestAPI.html#dumpProfilesTree">dumpProfilesTree</a></li><li><a href="module-api-ProfilesRestAPI.html#listProfiles">listProfiles</a></li><li><a href="module-api-ProfilesRestAPI.html#removeProfile">removeProfile</a></li><li><a href="module-api-ProfilesRestAPI.html#switchToProfile">switchToProfile</a></li></ul></div></li><li><a href="module-console-CommandManager.html">CommandManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:console~CommandManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-console-CommandManager.html#afterPropertiesSet">afterPropertiesSet</a></li><li><a href="module-console-CommandManager.html#setDependencies">setDependencies</a></li></ul></div></li><li><a href="module-console-ConsoleManager.html">ConsoleManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:console~ConsoleManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-console-ConsoleManager.html#afterPropertiesSet">afterPropertiesSet</a></li><li><a href="module-console-ConsoleManager.html#createConsole">createConsole</a></li><li><a href="module-console-ConsoleManager.html#getBuffer">getBuffer</a></li><li><a href="module-console-ConsoleManager.html#getInstanceLogger">getInstanceLogger</a></li><li><a href="module-console-ConsoleManager.html#mapStreamToLog">mapStreamToLog</a></li><li><a href="module-console-ConsoleManager.html#setDependencies">setDependencies</a></li><li><a href="module-console-ConsoleManager.html#writeBuffer">writeBuffer</a></li></ul></div></li><li><a href="module-entities-Entity.html">Entity</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:entities~Entity_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-entities-Entity.html#addChild">addChild</a></li><li><a href="module-entities-Entity.html#addParent">addParent</a></li><li><a href="module-entities-Entity.html#destroy">destroy</a></li><li><a href="module-entities-Entity.html#getChildEntities">getChildEntities</a></li><li><a href="module-entities-Entity.html#getIncomingRelationships">getIncomingRelationships</a></li><li><a href="module-entities-Entity.html#getOutgoingRelationships">getOutgoingRelationships</a></li><li><a href="module-entities-Entity.html#getParentEntities">getParentEntities</a></li><li><a href="module-entities-Entity.html#getType">getType</a></li><li><a href="module-entities-Entity.html#getUuid">getUuid</a></li><li><a href="module-entities-Entity.html#isChildEntity">isChildEntity</a></li><li><a href="module-entities-Entity.html#isParentEntity">isParentEntity</a></li><li><a href="module-entities-Entity.html#removeChildEntity">removeChildEntity</a></li><li><a href="module-entities-Entity.html#removeParentEntity">removeParentEntity</a></li></ul></div></li><li><a href="module-entities-EntityManager.html">EntityManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:entities~EntityManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-entities-EntityManager.html#create">create</a></li><li><a href="module-entities-EntityManager.html#getAll">getAll</a></li><li><a href="module-entities-EntityManager.html#getByUuid">getByUuid</a></li></ul></div></li><li><a href="module-entities-EntitySystem.html">EntitySystem</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:entities~EntitySystem_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-entities-EntitySystem.html#getEntityManager">getEntityManager</a></li><li><a href="module-entities-EntitySystem.html#getEntityTypeManager">getEntityTypeManager</a></li><li><a href="module-entities-EntitySystem.html#getRelationshipManager">getRelationshipManager</a></li><li><a href="module-entities-EntitySystem.html#getRelationshipTypeManager">getRelationshipTypeManager</a></li></ul></div></li><li><a href="module-entities-EntityType.html">EntityType</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:entities~EntityType_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-entities-EntityType.html#getEntities">getEntities</a></li><li><a href="module-entities-EntityType.html#getName">getName</a></li><li><a href="module-entities-EntityType.html#getUuid">getUuid</a></li><li><a href="module-entities-EntityType.html#isEntityOfType">isEntityOfType</a></li><li><a href="module-entities-EntityType.html#isEntityRegistered">isEntityRegistered</a></li><li><a href="module-entities-EntityType.html#register">register</a></li><li><a href="module-entities-EntityType.html#unregister">unregister</a></li></ul></div></li><li><a href="module-entities-EntityTypeManager.html">EntityTypeManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:entities~EntityTypeManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-entities-EntityTypeManager.html#create">create</a></li><li><a href="module-entities-EntityTypeManager.html#getAll">getAll</a></li><li><a href="module-entities-EntityTypeManager.html#getByUuid">getByUuid</a></li><li><a href="module-entities-EntityTypeManager.html#remove">remove</a></li></ul></div></li><li><a href="module-entities-Relationship.html">Relationship</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:entities~Relationship_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-entities-Relationship.html#disconnect">disconnect</a></li><li><a href="module-entities-Relationship.html#getEndEntity">getEndEntity</a></li><li><a href="module-entities-Relationship.html#getStartEntity">getStartEntity</a></li><li><a href="module-entities-Relationship.html#getType">getType</a></li><li><a href="module-entities-Relationship.html#getUuid">getUuid</a></li></ul></div></li><li><a href="module-entities-RelationshipManager.html">RelationshipManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:entities~RelationshipManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-entities-RelationshipManager.html#create">create</a></li><li><a href="module-entities-RelationshipManager.html#getAll">getAll</a></li><li><a href="module-entities-RelationshipManager.html#getByUuid">getByUuid</a></li><li><a href="module-entities-RelationshipManager.html#remove">remove</a></li></ul></div></li><li><a href="module-entities-RelationshipType.html">RelationshipType</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:entities~RelationshipType_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-entities-RelationshipType.html#getName">getName</a></li><li><a href="module-entities-RelationshipType.html#getUuid">getUuid</a></li><li><a href="module-entities-RelationshipType.html#isRelationshipOfType">isRelationshipOfType</a></li><li><a href="module-entities-RelationshipType.html#isRelationshipRegistered">isRelationshipRegistered</a></li><li><a href="module-entities-RelationshipType.html#register">register</a></li><li><a href="module-entities-RelationshipType.html#unregister">unregister</a></li></ul></div></li><li><a href="module-entities-RelationshipTypesManager.html">RelationshipTypesManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:entities~RelationshipTypesManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-entities-RelationshipTypesManager.html#create">create</a></li><li><a href="module-entities-RelationshipTypesManager.html#getAll">getAll</a></li><li><a href="module-entities-RelationshipTypesManager.html#getByName">getByName</a></li><li><a href="module-entities-RelationshipTypesManager.html#getByUuid">getByUuid</a></li><li><a href="module-entities-RelationshipTypesManager.html#remove">remove</a></li></ul></div></li><li><a href="module-gameclient-ScreenManager.html">ScreenManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:gameclient~ScreenManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-gameclient-ScreenManager.html#afterPropertiesSet">afterPropertiesSet</a></li><li><a href="module-gameclient-ScreenManager.html#onInstanceConnected">onInstanceConnected</a></li><li><a href="module-gameclient-ScreenManager.html#setDependencies">setDependencies</a></li></ul></div></li><li><a href="module-gameserver-IntermissionService.html">IntermissionService</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:gameserver~IntermissionService_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-gameserver-IntermissionService.html#afterPropertiesSet">afterPropertiesSet</a></li><li><a href="module-gameserver-IntermissionService.html#onInstanceConnected">onInstanceConnected</a></li><li><a href="module-gameserver-IntermissionService.html#setDependencies">setDependencies</a></li></ul></div></li><li><a href="module-gameserver-MapRotationService.html">MapRotationService</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:gameserver~MapRotationService_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-gameserver-MapRotationService.html#afterPropertiesSet">afterPropertiesSet</a></li><li><a href="module-gameserver-MapRotationService.html#getRandomMap">getRandomMap</a></li><li><a href="module-gameserver-MapRotationService.html#onIntermission">onIntermission</a></li><li><a href="module-gameserver-MapRotationService.html#setDependencies">setDependencies</a></li><li><a href="module-gameserver-MapRotationService.html#setMap">setMap</a></li></ul></div></li><li><a href="module-instances-Connector.html">Connector</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:instances~Connector_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-instances-Connector.html#protoDescriptor">protoDescriptor</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-instances-Connector.html#addSynchronizeListener">addSynchronizeListener</a></li><li><a href="module-instances-Connector.html#addTreeNodeSyncListenersFromDefaults">addTreeNodeSyncListenersFromDefaults</a></li><li><a href="module-instances-Connector.html#closeGrpcConnection">closeGrpcConnection</a></li><li><a href="module-instances-Connector.html#connect">connect</a></li><li><a href="module-instances-Connector.html#convert">convert</a></li><li><a href="module-instances-Connector.html#getDataType">getDataType</a></li><li><a href="module-instances-Connector.html#getDefaultValue">getDefaultValue</a></li><li><a href="module-instances-Connector.html#getEventType">getEventType</a></li><li><a href="module-instances-Connector.html#getId">getId</a></li><li><a href="module-instances-Connector.html#getLoggerName">getLoggerName</a></li><li><a href="module-instances-Connector.html#getMessage">getMessage</a></li><li><a href="module-instances-Connector.html#getPath">getPath</a></li><li><a href="module-instances-Connector.html#linkTreeMounts">linkTreeMounts</a></li><li><a href="module-instances-Connector.html#loadInstanceConfiguration">loadInstanceConfiguration</a></li><li><a href="module-instances-Connector.html#onNewTreeNode">onNewTreeNode</a></li><li><a href="module-instances-Connector.html#onTreeNodeSync">onTreeNodeSync</a></li><li><a href="module-instances-Connector.html#populateInstanceTreeFromDefaults">populateInstanceTreeFromDefaults</a></li><li><a href="module-instances-Connector.html#removeGrpcListeners">removeGrpcListeners</a></li><li><a href="module-instances-Connector.html#removeListeners">removeListeners</a></li><li><a href="module-instances-Connector.html#removeTreeListeners">removeTreeListeners</a></li><li><a href="module-instances-Connector.html#sendFinishedTreeIntro">sendFinishedTreeIntro</a></li><li><a href="module-instances-Connector.html#updateTree">updateTree</a></li></ul></div></li><li><a href="module-instances-InstanceManager.html">InstanceManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:instances~InstanceManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-instances-InstanceManager.html#afterPropertiesSet">afterPropertiesSet</a></li><li><a href="module-instances-InstanceManager.html#clear">clear</a></li><li><a href="module-instances-InstanceManager.html#connect">connect</a></li><li><a href="module-instances-InstanceManager.html#create">create</a></li><li><a href="module-instances-InstanceManager.html#disconnect">disconnect</a></li><li><a href="module-instances-InstanceManager.html#exists">exists</a></li><li><a href="module-instances-InstanceManager.html#getCurrentProfile">getCurrentProfile</a></li><li><a href="module-instances-InstanceManager.html#getHostname">getHostname</a></li><li><a href="module-instances-InstanceManager.html#getInstancesByState">getInstancesByState</a></li><li><a href="module-instances-InstanceManager.html#getInstancesByType">getInstancesByType</a></li><li><a href="module-instances-InstanceManager.html#getPort">getPort</a></li><li><a href="module-instances-InstanceManager.html#getTransition">getTransition</a></li><li><a href="module-instances-InstanceManager.html#isValidInstanceType">isValidInstanceType</a></li><li><a href="module-instances-InstanceManager.html#killProcess">killProcess</a></li><li><a href="module-instances-InstanceManager.html#loadInstances">loadInstances</a></li><li><a href="module-instances-InstanceManager.html#pause">pause</a></li><li><a href="module-instances-InstanceManager.html#remove">remove</a></li><li><a href="module-instances-InstanceManager.html#resume">resume</a></li><li><a href="module-instances-InstanceManager.html#saveInstances">saveInstances</a></li><li><a href="module-instances-InstanceManager.html#setDependencies">setDependencies</a></li><li><a href="module-instances-InstanceManager.html#shutdownProcess">shutdownProcess</a></li><li><a href="module-instances-InstanceManager.html#start">start</a></li><li><a href="module-instances-InstanceManager.html#startAll">startAll</a></li><li><a href="module-instances-InstanceManager.html#stop">stop</a></li><li><a href="module-instances-InstanceManager.html#stopAll">stopAll</a></li><li><a href="module-instances-InstanceManager.html#transist">transist</a></li></ul></div></li><li><a href="module-interfaces-LayerManager.html">LayerManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:interfaces~LayerManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-interfaces-LayerManager.html#afterPropertiesSet">afterPropertiesSet</a></li><li><a href="module-interfaces-LayerManager.html#createLayer">createLayer</a></li><li><a href="module-interfaces-LayerManager.html#hideLayer">hideLayer</a></li><li><a href="module-interfaces-LayerManager.html#reloadLayer">reloadLayer</a></li><li><a href="module-interfaces-LayerManager.html#removeLayer">removeLayer</a></li><li><a href="module-interfaces-LayerManager.html#setAcceptingKeyInput">setAcceptingKeyInput</a></li><li><a href="module-interfaces-LayerManager.html#setAcceptingMouseInput">setAcceptingMouseInput</a></li><li><a href="module-interfaces-LayerManager.html#setDependencies">setDependencies</a></li><li><a href="module-interfaces-LayerManager.html#setLayerUrl">setLayerUrl</a></li><li><a href="module-interfaces-LayerManager.html#showLayer">showLayer</a></li></ul></div></li><li><a href="module-interfaces-WebUserInterfaceManager.html">WebUserInterfaceManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:interfaces~WebUserInterfaceManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-interfaces-WebUserInterfaceManager.html#afterPropertiesSet">afterPropertiesSet</a></li><li><a href="module-interfaces-WebUserInterfaceManager.html#createInterface">createInterface</a></li><li><a href="module-interfaces-WebUserInterfaceManager.html#disableInterface">disableInterface</a></li><li><a href="module-interfaces-WebUserInterfaceManager.html#enableInterface">enableInterface</a></li><li><a href="module-interfaces-WebUserInterfaceManager.html#getAbsoluteFsPath">getAbsoluteFsPath</a></li><li><a href="module-interfaces-WebUserInterfaceManager.html#getFullUrl">getFullUrl</a></li><li><a href="module-interfaces-WebUserInterfaceManager.html#getInterfaceNames">getInterfaceNames</a></li><li><a href="module-interfaces-WebUserInterfaceManager.html#getPath">getPath</a></li><li><a href="module-interfaces-WebUserInterfaceManager.html#getRelativeFsPath">getRelativeFsPath</a></li><li><a href="module-interfaces-WebUserInterfaceManager.html#getRelativeUrl">getRelativeUrl</a></li><li><a href="module-interfaces-WebUserInterfaceManager.html#interfaceExists">interfaceExists</a></li><li><a href="module-interfaces-WebUserInterfaceManager.html#loadInterfaces">loadInterfaces</a></li><li><a href="module-interfaces-WebUserInterfaceManager.html#removeInterface">removeInterface</a></li><li><a href="module-interfaces-WebUserInterfaceManager.html#scanForInterfaces">scanForInterfaces</a></li><li><a href="module-interfaces-WebUserInterfaceManager.html#setDependencies">setDependencies</a></li><li><a href="module-interfaces-WebUserInterfaceManager.html#updateInterface">updateInterface</a></li><li><a href="module-interfaces-WebUserInterfaceManager.html#updateInterfaceNode">updateInterfaceNode</a></li></ul></div></li><li><a href="module-logging-LogManager.html">LogManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:logging~LogManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-logging-LogManager.html#afterPropertiesSet">afterPropertiesSet</a></li><li><a href="module-logging-LogManager.html#clear">clear</a></li><li><a href="module-logging-LogManager.html#createLogger">createLogger</a></li><li><a href="module-logging-LogManager.html#getLogger">getLogger</a></li><li><a href="module-logging-LogManager.html#loadLogConfiguration">loadLogConfiguration</a></li><li><a href="module-logging-LogManager.html#setDependencies">setDependencies</a></li><li><a href="module-logging-LogManager.html#setLoglevel">setLoglevel</a></li></ul></div></li><li><a href="module-media-FilesystemRepositoryManager.html">FilesystemRepositoryManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:media~FilesystemRepositoryManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-media-FilesystemRepositoryManager.html#afterPropertiesSet">afterPropertiesSet</a></li><li><a href="module-media-FilesystemRepositoryManager.html#setDependencies">setDependencies</a></li></ul></div></li><li><a href="module-media-GitRepositoryManager.html">GitRepositoryManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:media~GitRepositoryManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-media-GitRepositoryManager.html#afterPropertiesSet">afterPropertiesSet</a></li><li><a href="module-media-GitRepositoryManager.html#setDependencies">setDependencies</a></li></ul></div></li><li><a href="module-media-MapManager.html">MapManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:media~MapManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-media-MapManager.html#afterPropertiesSet">afterPropertiesSet</a></li><li><a href="module-media-MapManager.html#convert">convert</a></li><li><a href="module-media-MapManager.html#createConfigTree">createConfigTree</a></li><li><a href="module-media-MapManager.html#findMapFiles">findMapFiles</a></li><li><a href="module-media-MapManager.html#getMapNames">getMapNames</a></li><li><a href="module-media-MapManager.html#loadMapConfiguration">loadMapConfiguration</a></li><li><a href="module-media-MapManager.html#setDependencies">setDependencies</a></li><li><a href="module-media-MapManager.html#updateMaps">updateMaps</a></li></ul></div></li><li><a href="module-media-MediaManager.html">MediaManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:media~MediaManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-media-MediaManager.html#addMedia">addMedia</a></li><li><a href="module-media-MediaManager.html#afterPropertiesSet">afterPropertiesSet</a></li><li><a href="module-media-MediaManager.html#setDependencies">setDependencies</a></li></ul></div></li><li><a href="module-media-MediaRepositoryManager.html">MediaRepositoryManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:media~MediaRepositoryManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-media-MediaRepositoryManager.html#afterPropertiesSet">afterPropertiesSet</a></li><li><a href="module-media-MediaRepositoryManager.html#setDependencies">setDependencies</a></li></ul></div></li><li><a href="module-media-TextureManager.html">TextureManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:media~TextureManager_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-media-TextureManager.html#textureTypes">textureTypes</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-media-TextureManager.html#afterPropertiesSet">afterPropertiesSet</a></li><li><a href="module-media-TextureManager.html#findTextureFilesByTypes">findTextureFilesByTypes</a></li><li><a href="module-media-TextureManager.html#setDependencies">setDependencies</a></li><li><a href="module-media-TextureManager.html#updateTextures">updateTextures</a></li></ul></div></li><li><a href="module-profiles-ProfileManager.html">ProfileManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:profiles~ProfileManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-profiles-ProfileManager.html#afterPropertiesSet">afterPropertiesSet</a></li><li><a href="module-profiles-ProfileManager.html#create">create</a></li><li><a href="module-profiles-ProfileManager.html#exists">exists</a></li><li><a href="module-profiles-ProfileManager.html#getAllProfiles">getAllProfiles</a></li><li><a href="module-profiles-ProfileManager.html#getConfigPath">getConfigPath</a></li><li><a href="module-profiles-ProfileManager.html#getCurrentProfile">getCurrentProfile</a></li><li><a href="module-profiles-ProfileManager.html#getCurrentProfileName">getCurrentProfileName</a></li><li><a href="module-profiles-ProfileManager.html#getDefaultProfile">getDefaultProfile</a></li><li><a href="module-profiles-ProfileManager.html#getDefaultProfileName">getDefaultProfileName</a></li><li><a href="module-profiles-ProfileManager.html#getProfile">getProfile</a></li><li><a href="module-profiles-ProfileManager.html#getProfilesConfigPath">getProfilesConfigPath</a></li><li><a href="module-profiles-ProfileManager.html#loadProfiles">loadProfiles</a></li><li><a href="module-profiles-ProfileManager.html#remove">remove</a></li><li><a href="module-profiles-ProfileManager.html#saveProfiles">saveProfiles</a></li><li><a href="module-profiles-ProfileManager.html#setCurrentProfile">setCurrentProfile</a></li><li><a href="module-profiles-ProfileManager.html#setDependencies">setDependencies</a></li><li><a href="module-profiles-ProfileManager.html#switchTo">switchTo</a></li></ul></div></li><li><a href="module-releases-ReleaseManager.html">ReleaseManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:releases~ReleaseManager_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-releases-ReleaseManager.html#fetching">fetching</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-releases-ReleaseManager.html#afterPropertiesSet">afterPropertiesSet</a></li><li><a href="module-releases-ReleaseManager.html#checkForNewReleases">checkForNewReleases</a></li><li><a href="module-releases-ReleaseManager.html#determinePlatform">determinePlatform</a></li><li><a href="module-releases-ReleaseManager.html#downloadRelease">downloadRelease</a></li><li><a href="module-releases-ReleaseManager.html#getBinaryPath">getBinaryPath</a></li><li><a href="module-releases-ReleaseManager.html#getConfigPath">getConfigPath</a></li><li><a href="module-releases-ReleaseManager.html#getExecutableName">getExecutableName</a></li><li><a href="module-releases-ReleaseManager.html#getOrInstallRelease">getOrInstallRelease</a></li><li><a href="module-releases-ReleaseManager.html#getRelease">getRelease</a></li><li><a href="module-releases-ReleaseManager.html#getVersionStrFromZipName">getVersionStrFromZipName</a></li><li><a href="module-releases-ReleaseManager.html#installRelease">installRelease</a></li><li><a href="module-releases-ReleaseManager.html#loadConfig">loadConfig</a></li><li><a href="module-releases-ReleaseManager.html#makeZipNameFromVersion">makeZipNameFromVersion</a></li><li><a href="module-releases-ReleaseManager.html#mkdirLocalCache">mkdirLocalCache</a></li><li><a href="module-releases-ReleaseManager.html#saveConfig">saveConfig</a></li><li><a href="module-releases-ReleaseManager.html#setDependencies">setDependencies</a></li><li><a href="module-releases-ReleaseManager.html#uninstallRelease">uninstallRelease</a></li></ul></div></li><li><a href="module-treeclient-TreeClient.html">TreeClient</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:treeclient~TreeClient_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-treeclient-TreeClient.html#branchMediaRepository">branchMediaRepository</a></li><li><a href="module-treeclient-TreeClient.html#callEndpoint">callEndpoint</a></li><li><a href="module-treeclient-TreeClient.html#clientWindowFullscreen">clientWindowFullscreen</a></li><li><a href="module-treeclient-TreeClient.html#clientWindowMaximize">clientWindowMaximize</a></li><li><a href="module-treeclient-TreeClient.html#clientWindowMinimize">clientWindowMinimize</a></li><li><a href="module-treeclient-TreeClient.html#clientWindowRestore">clientWindowRestore</a></li><li><a href="module-treeclient-TreeClient.html#connectInstance">connectInstance</a></li><li><a href="module-treeclient-TreeClient.html#createEndpoint">createEndpoint</a></li><li><a href="module-treeclient-TreeClient.html#createInstance">createInstance</a></li><li><a href="module-treeclient-TreeClient.html#createMediaRepository">createMediaRepository</a></li><li><a href="module-treeclient-TreeClient.html#createProfile">createProfile</a></li><li><a href="module-treeclient-TreeClient.html#deleteTreeNode">deleteTreeNode</a></li><li><a href="module-treeclient-TreeClient.html#downloadRelease">downloadRelease</a></li><li><a href="module-treeclient-TreeClient.html#dumpInstanceTree">dumpInstanceTree</a></li><li><a href="module-treeclient-TreeClient.html#fetchReleases">fetchReleases</a></li><li><a href="module-treeclient-TreeClient.html#getAllInstances">getAllInstances</a></li><li><a href="module-treeclient-TreeClient.html#getEndpointUrl">getEndpointUrl</a></li><li><a href="module-treeclient-TreeClient.html#getFlexLog">getFlexLog</a></li><li><a href="module-treeclient-TreeClient.html#getFlexSysInfo">getFlexSysInfo</a></li><li><a href="module-treeclient-TreeClient.html#getFlexVersion">getFlexVersion</a></li><li><a href="module-treeclient-TreeClient.html#getInstance">getInstance</a></li><li><a href="module-treeclient-TreeClient.html#getReleaseInfo">getReleaseInfo</a></li><li><a href="module-treeclient-TreeClient.html#getTreeNode">getTreeNode</a></li><li><a href="module-treeclient-TreeClient.html#installRelease">installRelease</a></li><li><a href="module-treeclient-TreeClient.html#listReleases">listReleases</a></li><li><a href="module-treeclient-TreeClient.html#loadReleases">loadReleases</a></li><li><a href="module-treeclient-TreeClient.html#readHJsonConfig">readHJsonConfig</a></li><li><a href="module-treeclient-TreeClient.html#readTOMLConfig">readTOMLConfig</a></li><li><a href="module-treeclient-TreeClient.html#removeInstance">removeInstance</a></li><li><a href="module-treeclient-TreeClient.html#removeMediaRepository">removeMediaRepository</a></li><li><a href="module-treeclient-TreeClient.html#removeProfile">removeProfile</a></li><li><a href="module-treeclient-TreeClient.html#saveReleases">saveReleases</a></li><li><a href="module-treeclient-TreeClient.html#scanMediaRepositories">scanMediaRepositories</a></li><li><a href="module-treeclient-TreeClient.html#setTreeNode">setTreeNode</a></li><li><a href="module-treeclient-TreeClient.html#shutdownFlex">shutdownFlex</a></li><li><a href="module-treeclient-TreeClient.html#startAllInstances">startAllInstances</a></li><li><a href="module-treeclient-TreeClient.html#startInstance">startInstance</a></li><li><a href="module-treeclient-TreeClient.html#stopAllInstances">stopAllInstances</a></li><li><a href="module-treeclient-TreeClient.html#stopInstance">stopInstance</a></li><li><a href="module-treeclient-TreeClient.html#switchProfile">switchProfile</a></li><li><a href="module-treeclient-TreeClient.html#synchronizeInstance">synchronizeInstance</a></li><li><a href="module-treeclient-TreeClient.html#uninstallRelease">uninstallRelease</a></li><li><a href="module-treeclient-TreeClient.html#updateMediaRepository">updateMediaRepository</a></li></ul></div></li><li><a href="module-tree-Root.html">Root</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:tree~Root_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-tree-Root.html#contains">contains</a></li></ul></div></li><li><a href="module-tree-TreeNode.html">TreeNode</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:tree~TreeNode_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-tree-TreeNode.html#getFlatRepresentation">getFlatRepresentation</a></li><li><a href="module-tree-TreeNode.html#Symbol.iterator">Symbol.iterator</a></li></ul></div></li><li><a href="PidManager.html">PidManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="PidManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="PidManager.html#createPid">createPid</a></li></ul></div></li><li><a href="ProcessManager.html">ProcessManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ProcessManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="ProcessManager.html#createProcessHandlers">createProcessHandlers</a></li><li><a href="ProcessManager.html#onExit">onExit</a></li><li><a href="ProcessManager.html#onReloadSignal">onReloadSignal</a></li><li><a href="ProcessManager.html#onSegfault">onSegfault</a></li><li><a href="ProcessManager.html#onShutdownSignal">onShutdownSignal</a></li><li><a href="ProcessManager.html#onUncaughtException">onUncaughtException</a></li></ul></div></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const EventEmitter = require('events');
const fs = require('fs');
const path = require('path');
const git = require('nodegit');
const util = require('util');
const mkdirp = require('mkdirp');
const progress = require('progress');

const inexor_path = require('@inexorgame/path');

/**
 * The media repository types.
 * Future types may be 'http+rest', 'mongo'
 * @module media
 */
const repository_types = [
  'fs',
  'git'
];

class FilesystemRepositoryManager extends EventEmitter {

  /**
   * Constructs the FilesystemRepositoryManager.
   * @constructor
   * @param {tree.Node} repositoriesNode - The repositories tree node.
   */
  constructor(applicationContext) {
    super();
  }

  /**
   * Sets the dependencies from the application context.
   */
  setDependencies() {

    /// The Inexor Tree root node
    this.root = this.applicationContext.get('tree');

    /// The Inexor Tree node containing media
    this.mediaNode = this.root.getOrCreateNode('media');

    /// Creating a tree node containing the media repositories
    this.repositoriesNode = this.mediaNode.getOrCreateNode('repositories');

    /// The class logger
    this.log = this.applicationContext.get('logManager').getLogger('flex.media.repository.FilesystemRepositoryManager');

  }

  /**
   * Initialization after the components in the application context have been
   * constructed.
   */
  afterPropertiesSet() {

    /// Scan for filesystem repositories
    /// this.scanAll();

  }

  /**
   * Scans the file system for media repositories starting at the base dir.
   * @function
   * @name FilesystemRepositoryManager.scan
   * @param {string} mediaPath - The starting point for scanning.
   * @return An array containing the created repository nodes.
   */
  scan(mediaPath = null) {
    var nodes = [];
    var _mediaPath = mediaPath;
    if (_mediaPath == null) {
      _mediaPath = inexor_path.media_path;
    }

    if (fs.existsSync(_mediaPath)) {
      try {
        this.log.debug(util.format('Scaning media path %s for FS media repositories', _mediaPath));
        let subDirs = this.get_sub_directories(_mediaPath);
        for (let i = 0; i &lt; subDirs.length; i++) {
          let repository_name = subDirs[i];
          var repository_dir = path.join(_mediaPath, repository_name);
          if (!this.exists(repository_name)) {
            try {
              let node = this.addRepository(repository_name, repository_dir);
              if (node != null) {
                nodes.push(node);
                this.log.info(util.format('Added FS media repository %s: %s', repository_name, repository_dir));
              }
            } catch (err) {
              this.log.warn(err.message);
            }
          } else {
            this.log.debug(util.format('Skipping known media repository %s: %s', repository_name, repository_dir));
          }
        }
      } catch (err) {
        this.log.warn(util.format('Failed to scan media path %s: %s', _mediaPath, err.message));
      }
    } else {
      this.log.debug(util.format('Path does not exist: %s ', _mediaPath));
    }
    return nodes;
  }

  /**
   * Scans all media paths. This includes system wide repositories (for
   * example in /usr/local/share/).
   * @function
   * @name FilesystemRepositoryManager.scanAll
   */
  scanAll() {
    var mediaPaths = inexor_path.getMediaPaths();
    for (var i = 0; i &lt; mediaPaths.length; i++) {
      this.scan(mediaPaths[i]);
    }
  }

  /**
   * Returns true if a media repository exists in the Inexor Tree.
   * @function
   * @name FilesystemRepositoryManager.exists
   * @return {boolean}
   */
  exists(name) {
    return this.repositoriesNode.hasChild(name);
  }

  /**
   * Returns a list of sub directories for the given path.
   * @function
   * @name FilesystemRepositoryManager.get_sub_directories
   */
  get_sub_directories(_path) {
    return fs.readdirSync(_path).filter(function(file) {
      return fs.statSync(path.join(_path, file)).isDirectory();
    });
  }

  /**
   * Adds an existing media repository to the Inexor Tree. The repository is located
   * at the local filesystem. The given path must exist!
   * @function
   * @name FilesystemRepositoryManager.addRepository
   * @param {string} name - The name of the media repository
   * @param {string} repositoryPath - The absolute path to the base folder of the media repository.
   * @return {Node} The repository node.
   */
  addRepository(name, repositoryPath) {
    if (name != null &amp;&amp; repositoryPath != null) {
      if (!this.exists(name)) {
        if (fs.existsSync(repositoryPath)) {
          if (!fs.existsSync(path.join(repositoryPath, '.git'))) {
            let node = this.repositoriesNode.addNode(name);
            node.addChild('type', 'string', 'filesystem');
            node.addChild('path', 'string', repositoryPath);
            return node;
          } else {
            // Prevent registering a repository of type GIT as a FS repository;
            return null;
          }
        } else {
          throw new Error('Directory doesn\'t exist: ' + repositoryPath);
        }
      } else {
        throw new Error('A repository with name ' + name + ' already exists!');
      }
    } else {
      throw new Error('Name and path are mandatory!');
    }
  }

  /**
   * Creates a new media repository located at the local filesystem. The given path
   * must not exist and the folder will be created.
   * @function
   * @name FilesystemRepositoryManager.createRepository
   * @param {string} name - The name of the media repository
   * @param {string} repositoryPath - The absolute path to the base folder of the media repository.
   * @return {Node} The repository node.
   */
  createRepository(name, repositoryPath) {
    if (name != null &amp;&amp; repositoryPath != null) {
      if (!this.exists(name)) {
        if (!fs.existsSync(repositoryPath)) {
          let node = this.repositoriesNode.addNode(name);
          node.addChild('type', 'string', 'filesystem');
          node.addChild('path', 'string', repositoryPath);
          fs.mkdirSync(repositoryPath);
          return node;
        } else {
          throw new Error('The given path already exists: ' + repositoryPath);
        }
      } else {
        throw new Error('A repository with name ' + name + ' already exists!');
      }
    } else {
      throw new Error('Name and path are mandatory!');
    }
  }

}

class GitRepositoryManager extends EventEmitter {

  /**
   * Constructs the FilesystemRepositoryManager.
   * @constructor
   * @param {tree.Node} repositoriesNode - The repositories tree node.
   */
  constructor(applicationContext) {
    super();
  }

  /**
   * Sets the dependencies from the application context.
   */
  setDependencies() {

    /// The Inexor Tree root node
    this.root = this.applicationContext.get('tree');

    /// The Inexor Tree node containing media
    this.mediaNode = this.root.getOrCreateNode('media');

    /// Creating a tree node containing the media repositories
    this.repositoriesNode = this.mediaNode.getOrCreateNode('repositories');

    /// The class logger
    this.log = this.applicationContext.get('logManager').getLogger('flex.media.repository.GitRepositoryManager');

    /// Internal only. Holds the release progress bars
    this.bars = {}
  }

  /**
   * Initialization after the components in the application context have been
   * constructed.
   */
  afterPropertiesSet() {

    /// Scan for filesystem repositories
    /// this.scanAll();

  }

  /**
   * Scans the file system for media repositories starting at the base dir.
   * @function
   * @name GitRepositoryManager.scan
   * @param {string} mediaPath - The starting point for scanning.
   * @return An array containing the created repository nodes.
   */
  scan(mediaPath = null) {
    var nodes = [];
    var _mediaPath = mediaPath;
    if (_mediaPath == null) {
      _mediaPath = inexor_path.media_path;
    }
    if (fs.existsSync(_mediaPath)) {
      try {
        this.log.debug(util.format('Scaning media path %s for GIT media repositories', _mediaPath));
        let subDirs = this.get_sub_directories(_mediaPath);
        for (let i = 0; i &lt; subDirs.length; i++) {
          let repository_name = subDirs[i];
          var repository_dir = path.join(_mediaPath, repository_name);
          if (!this.exists(repository_name)) {
            try {
              let node = this.addRepository(repository_name, repository_dir);
              nodes.push(node);
              this.log.info(util.format('Added GIT media repository %s: %s', repository_name, repository_dir));
            } catch (err) {
              this.log.warn(err.message);
            }
          } else {
            this.log.debug(util.format('Skipping known media repository %s: %s', repository_name, repository_dir));
          }
        }
      } catch (err) {
        this.log.warn(util.format('Failed to scan media path %s: %s', _mediaPath, err.message));
      }
    } else {
      this.log.debug(util.format('Path does not exist: %s ', _mediaPath));
    }
    return nodes;
  }

  /**
   * Scans all media paths. This includes system wide repositories (for
   * example in /usr/local/share/).
   * @function
   * @name GitRepositoryManager.scanAll
   */
  scanAll() {
    var mediaPaths = inexor_path.getMediaPaths();
    for (var i = 0; i &lt; mediaPaths.length; i++) {
      this.scan(mediaPaths[i]);
    }
  }

  /**
   * Returns true if a media repository exists in the Inexor Tree.
   * @function
   * @name GitRepositoryManager.exists
   * @return {boolean}
   */
  exists(name) {
    return this.repositoriesNode.hasChild(name);
  }

  /**
   * Returns a list of sub directories for the given path.
   * @function
   * @name GitRepositoryManager.get_sub_directories
   */
  get_sub_directories(_path) {
    return fs.readdirSync(_path).filter(function(file) {
      return fs.statSync(path.join(_path, file)).isDirectory();
    });
  }

  /**
   * Adds an existing GIT repository to the Inexor Tree.
   * @function
   * @name GitRepositoryManager.addRepository
   * @param {string} name - The name of the media repository
   * @param {string} repositoryPath - The absolute path to the base folder of the media repository.
   * --------- @param {string} url - The url of the remote GIT repository. ---------
   * @return {Node} The repository node.
   */
  addRepository(name, repositoryPath /*, url */) {
    if (name != null &amp;&amp; repositoryPath != null) {
      if (!this.exists(name)) {
        if (fs.existsSync(repositoryPath)) {
          if (this.isGitRepository(repositoryPath)) {
            let node = this.repositoriesNode.addNode(name);
            node.addChild('type', 'string', 'git');
            node.addChild('path', 'string', repositoryPath);
            node.addChild('url', 'string', '');
            node.addChild('branch', 'string', 'master');
            node.addNode('branches');
            // Update the repository
            this.update(name);
            return node;
          } else {
            throw new Error('The repository is not of type GIT');
          }
        } else {
          throw new Error('Directory doesn\'t exist: ' + repositoryPath);
        }
      } else {
        throw new Error('A repository with name ' + name + ' already exists!');
      }
    } else {
      throw new Error('Name and path are mandatory!');
    }
  }

  /**
   * Returns true, if the media repository is a git repository.
   * @function
   * @name GitRepositoryManager.isGitRepository
   * @param {string} repositoryPath - The absolute path to the base folder of the media repository.
   * @return {boolean} The repository node.
   */
  isGitRepository(repositoryPath) {
    return fs.existsSync(path.join(repositoryPath, '.git'))
  }

  /**
   * Creates a new git repository. The local path must not exist. After creation the
   * @function
   * @name GitRepositoryManager.createRepository
   * @param {string} name - The name of the media repository
   * @param {string} repositoryPath - The absolute path to the base folder of the media repository.
   * @param {string} url - The url of the remote GIT repository.
   * @return {Promise&lt;Node>} The repository node.
   */
  createRepository(name, repositoryPath, url) {
    return new Promise((resolve, reject) => {
        if (name != null &amp;&amp; repositoryPath != null) {
            if (!this.exists(name)) {
                if (!fs.existsSync(repositoryPath)) {
                    let node = this.repositoriesNode.addNode(name);
                    // TODO: use the javascript getter/setter magic!
                    // node.type = 'git';
                    node.addChild('type', 'string', 'git');
                    node.addChild('path', 'string', repositoryPath);
                    node.addChild('url', 'string', url);
                    node.addChild('branch', 'string', 'master');
                    node.addNode('branches');
                    // Initially clone the repository
                    this.update(name, null, true).then((branch) => {
                      resolve(node);
                    });
                } else {
                    reject(new Error(`Directory already exist: ${repositoryPath}`));
                }
            } else {
                reject(new Error(`A repository with name ${name} already exists!`));
            }
        } else {
            reject(new Error('Name and path are mandatory!'));
        }
    })
  }

  /**
   * Updates the download progress of a node
   * @private
   * @param {Object} stats {@link https://github.com/nodegit/nodegit/issues/1167}
   * @param {Node} node
   * // TODO: Write a generic function because this is used more often. Also have a look at https://github.com/inexorgame/inexor-core/issues/482
   */
  updateStats(stats, node) {
      if (this.bars[node.getName()] === undefined) {
          this.bars[node.getName()] = new progress(`Downloading repository ${node.getName()} [:bar] :current / :total`, {total: stats.totalObjects(), stream: this.log.stream});
      } else {
          this.bars[node.getName()].tick((100 * (stats.receivedObjects() + stats.indexedObjects())) / (stats.totalObjects() * 2))
      }

      ['indexedObjects', 'totalObjects', 'receivedObjects'].forEach((key) => {
          if (node.hasChild(key)) {
              node.getChild(key).set(stats[key]())
          } else {
              node.addChild(key, 'int64', stats[key]())
          }
      })
  }

  /**
   * Updates a git repository.
   * @function
   * @name GitRepositoryManager.update
   * @param {string} name - The repository name.
   * @param {string} branch_name - If true, the repository will be cloned.
   * @param {boolean} clone - If true, the repository will be cloned.
   * @return {Promise&lt;string>} Returns the name of the current branch
   */
  update(name, branch_name = null, clone = false) {
    return new Promise((resolve, reject) => {
        let repositoryNode = this.repositoriesNode.getChild(name);
        let repositoryPath = this.repositoriesNode.getChild(name).path;
        var self = this;
        if (clone) {
            // git clone
            this.log.info(util.format('Cloning media repository %s from %s to local path %s', name, repositoryNode.url, repositoryNode.path));
            var repository;
            git.Clone(repositoryNode.url, repositoryNode.path, {
                fetchOpts: {
                    callbacks: {
                        certificateCheck: function() {
                            return 1;
                        },
                        transferProgress: {
                          throttle: 2000,
                          callback: function(stats) {
                              self.updateStats(stats, repositoryNode);
                          }
                        }
                    }
                }
            }).then(function(repo) {
                repository = repo;
                delete(self.bars[name]);
                self.log.info(util.format('Successfully cloned media repository %s', name));
                return self.getBranches(name, repository);
            }).then(function(repository) {
                resolve(self.getCurrentBranch(name, repository));
            }).catch(function(err) {
                self.log.error(err);
            });
        } else {
            // git pull
            // TODO: Resolve the repository url first!
            this.log.debug(util.format('[%s] Updating media repository (url: %s local: %s)', name, repositoryNode.url, repositoryNode.path));
            git.Repository
                .open(repositoryPath)
                .then(function(repo) {
                    repository = repo;
                    self.log.trace(util.format('[%s] Opened media repository', name));
                    return self.getBranches(name, repository);
                })
                .then(function(repository) {
                    return self.getCurrentBranch(name, repository);
                })
                .then(function(repository) {
                    return self.fetchAll(name, repository, {
                        fetchOpts: {
                            callbacks: {
                                certificateCheck: function() {
                                    return 1;
                                },
                                transferProgress: {
                                    throttle: 2000,
                                    callback: function(stats) {
                                        self.updateStats(stats, repositoryNode);
                                    }
                                }
                            }
                        }
                    });
                })
                .then(function(repository) {
                    delete(self.bars[name]);
                    return self.mergeBranches(name, repository);
                })
                .then(function(repository) {
                    if (branch_name != null) {
                        return self.checkoutBranch(name, repository, branch_name);
                    } else {
                        return repository;
                    }
                })
                .done(function() {
                    let msg = `Successfully updated media repository ${name}`;
                    self.log.info(msg);
                    resolve(msg);
                });
        }
    })
  }

  /**
   * Fetches updates from the remote repository.
   * @function
   * @name GitRepositoryManager.mergeBranches
   * @param {string} name - The repository name.
   * @param {Repository} repository - The git repository.
   */
  fetchAll(name, repository) {
    var self = this;
    this.log.debug(util.format('[%s] Fetching new data from remote', name));
    return repository
      .fetchAll({
        callbacks: {
          certificateCheck: function() {
            return 1;
          },
          transferProgress: (stats) => {
            const received = stats.receivedObjects();
            const indexed = stats.indexedObjects();
            const total = stats.totalObjects();
            const bytes = stats.receivedBytes();
            var b = bytes;
            var u = 'bytes';
            if (b > 4096) {
              b = b / 1024;
              u = 'KB';
            }
            if (b > 4096) {
              b = b / 1024;
              u = 'MB';
            }
            if (b > 4096) {
              b = b / 1024;
              u = 'GB';
            }
            const progress = (100 * (received + indexed)) / (total * 2);
            self.log.debug(util.format('[%s] Fetching: %s %s, Objects: %d/%d/%d (%s %%)', name, b.toFixed(1), u, received, indexed, total, progress.toFixed(1)));
          }
        }
      })
      .then(function() {
        self.log.debug(util.format('[%s] Successfully fetched data', name));
        return repository;
      })
      .catch(function(err) {
        self.log.error(util.format('[%s] Failed to fetched data: %s', name, err.message));
        return repository;
      });
  }

  /**
   * Merges the previously fetched updates from remote into the local copy.
   * @function
   * @name GitRepositoryManager.mergeBranches
   * @param {string} name - The repository name.
   * @param {Repository} repository - The git repository.
   */
  mergeBranches(name, repository) {
    var self = this;
    try {
      // All available branches
      let branchesNode = this.repositoriesNode.getChild(name).branches;
      // The name of the current branch
      let branchNode = this.repositoriesNode.getChild(name).getChild('branch');
      self.log.trace(util.format('[%s] Branch Node: %s', name, branchNode.get()));
      // The node of the current branch
      let currentBranchNode = branchesNode.getChild(branchNode.get());
      // Get or create the remote reference node
      let remoteReferenceNode;
      if (!currentBranchNode.hasChild('remote')) {
        remoteReferenceNode = currentBranchNode.addChild('remote', 'string', util.format('refs/remotes/origin/%s', branchNode.get()));
      } else {
        remoteReferenceNode = currentBranchNode.getChild('remote');
      }
      self.log.trace(util.format('[%s] Remote reference: %s', name, remoteReferenceNode.get()));
      let remoteBranchShorthand = remoteReferenceNode.get().substr(13);
      // Get or create the local reference node
      let localReferenceNode;
      let localReferenceExists;
      if (!currentBranchNode.hasChild('local')) {
        localReferenceNode = currentBranchNode.addChild('local', 'string', util.format('refs/heads/%s', branchNode.get()));
        localReferenceExists = false;
      } else {
        localReferenceNode = currentBranchNode.getChild('local');
        localReferenceExists = true;
      }
      self.log.trace(util.format('[%s] Local reference: %s', name, localReferenceNode.get()));
      let localBranchShorthand = localReferenceNode.get().substr(11);
      if (localReferenceExists) {
        self.log.debug(util.format('[%s] Merging new data from remote branch %s into local branch %s', name, remoteBranchShorthand, localBranchShorthand));
        return repository
          .mergeBranches(localBranchShorthand, remoteBranchShorthand)
          .then(function() {
            self.log.trace(util.format('[%s] Successfully merged new data', name));
            return repository;
          })
          .catch(function(err) {
            self.log.error(err, util.format('[%s] Failed to merge data: %s', name, err.message));
            return repository;
          });
      } else {
        return self.checkoutBranch(name, repository, localBranchShorthand)
          .then(function() {
            self.log.debug(util.format('[%s] Merging new data from remote branch %s into local branch %s', name, remoteBranchShorthand, localBranchShorthand));
            return repository
              .mergeBranches(localBranchShorthand, remoteBranchShorthand)
              .then(function() {
                self.log.trace(util.format('[%s] Successfully merged new data', name));
                return repository;
              })
              .catch(function(err) {
                self.log.error(err, util.format('[%s] Failed to merge data: %s', name, err.message));
                return repository;
              });
          })
          .catch(function(err) {
            self.log.error(err, util.format('[%s] Failed checkout branch: %s', name, err.message));
            return repository;
          });
      }
    } catch (err) {
      self.log.error(err, util.format('[%s] Failed to merge data: %s', name, err.message));
      return repository;
    }
  }

  /**
   * Checkout the given branch.
   * @function
   * @name GitRepositoryManager.checkoutBranch
   * @param {string} name - The repository name.
   * @param {Repository} repository - The git repository.
   * @param {string} branch_name - If true, the repository will be cloned.
   */
  checkoutBranch(name, repository, branch_name) {
    let branchNode = this.repositoriesNode.getChild(name).getChild('branch');
    var self = this;
    return repository
      .getBranch('refs/remotes/origin/' + branch_name)
      .then(function(reference) {
        self.log.trace(util.format('[%s] Branch %s reference is %s', name, branch_name, reference.toString()));
        let branch_name = reference.toString().substr(20);
        if (branch_name == '') {
          branch_name = 'master';
          self.log.warn(util.format('[%s] Reference invalid: %s! Using master branch!', name, reference.toString()));
        }
        self.log.info(util.format('[%s] Checking out branch %s (%s)', name, branch_name, reference.toString()));
        branchNode.set(branch_name);
        return repository
          .checkoutBranch(branch_name)
          .then(function() {
            this.log.info(util.format('[%s] Successfully checked out branch %s (%s)', name, branch_name, reference.toString()));
            return repository;
          })
          .catch(function(err) {
            self.log.error(err, util.format('[%s] Checkout branch %s failed. Need to create local branch.', name, branch_name));
            return repository
              .checkoutRef(reference)
              .then(function(commit) {
                self.log.debug(util.format('[%s] Creating local branch %s', name, branch_name));
                return repository
                  .getHeadCommit()
                  .then(function(commit) {
                    return repository
                      .createBranch(branch_name, commit, true)
                      .then(function(reference) {
                        self.log.trace(util.format('[%s] Successfully created local branch %s (%s)', name, branch_name, reference.toString()));
                        return repository
                          .checkoutBranch(branch_name)
                          .then(function() {
                            self.log.trace(util.format('[%s] Successfully checked out branch %s (%s)', name, branch_name, reference.toString()));
                            return repository;
                          })
                          .catch(function() {
                            return repository;
                          });
                      })
                      .catch(function() {
                        return repository;
                      });
                  })
                  .catch(function() {
                    return repository;
                  });
              })
              .catch(function() {
                return repository;
              });
          });
      })
      .catch(function() {
        return repository;
      });
  }

  /**
   * Sets the current branch name of the given repository in the Inexor Tree.
   * @function
   * @name GitRepositoryManager.getCurrentBranch
   * @param {string} name - The repository name.
   * @param {Repository} repository - The git repository.
   */
  getCurrentBranch(name, repository) {
    let branchNode = this.repositoriesNode.getChild(name).getChild('branch');
    var self = this;
    return repository
      .getCurrentBranch()
      .then(function(reference) {
        self.log.trace(util.format('[%s] Current branch reference: %s', name, reference));
        try {
          let branch_name = reference.toString().substr(11);
          if (branch_name != '') {
            branchNode.set(branch_name);
            self.log.debug(util.format('[%s] Current branch is %s', name, branch_name));
          } else {
            branchNode.set('master');
            self.log.warn(util.format('[%s] Failed to get current branch, assuming master branch!', name));
          }
        } catch (err) {
          branchNode.set('master');
          self.log.error(err, util.format('[%s] Failed to get current branch: %s', name, err.message));
        }
        return repository;
      })
      .catch(function(err) {
        branchNode.set('master');
        self.log.error(util.format('[%s] Failed to get current branch: %s. The repository %s seems to be corrupt', name, err.message, name));
        return repository;
      });
  }

  /**
   * Sets the branch names of the given repository in the Inexor Tree.
   * @function
   * @name GitRepositoryManager.getBranches
   * @param {string} name - The repository name.
   * @param {Repository} repository - The git repository.
   */
  getBranches(name, repository) {
    let branchesNode = this.repositoriesNode.getChild(name).branches;
    var self = this;
    return repository
      .getReferenceNames(git.Reference.TYPE.LISTALL)
      .then(function(reference_names) {
        try {
          for (var i = 0; i &lt; reference_names.length; i++) {
            var reference_name = reference_names[i];
            var branch_name, branchNode;

            if (reference_name.substr(0, 11) == 'refs/heads/') {
              // local branch
              branch_name = reference_name.substr(11);
              if (branchesNode.hasChild(branch_name)) {
                branchNode = branchesNode.getChild(branch_name);
              } else {
                branchNode = branchesNode.addNode(branch_name);
              }
              if (branchNode.hasChild('local')) {
                branchNode.getChild('local').set(reference_name);
              } else {
                branchNode.addChild('local', 'string', reference_name);
              }
              self.log.trace(util.format('[%s] Found local branch %s', name, branch_name));
            } else if (reference_name.substr(0, 20) == 'refs/remotes/origin/') {
              // remote branch
              branch_name = reference_name.substr(20);
              if (branchesNode.hasChild(branch_name)) {
                branchNode = branchesNode.getChild(branch_name);
              } else {
                branchNode = branchesNode.addNode(branch_name);
              }
              if (branchNode.hasChild('remote')) {
                branchNode.getChild('remote').set(reference_name);
              } else {
                branchNode.addChild('remote', 'string', reference_name);
              }
              self.log.trace(util.format('[%s] Found remote branch %s', name, branch_name));
            }
          }
          self.log.trace(util.format('[%s] List of branches and references:\n%s', name, branchesNode.toJson()));
        } catch (err) {
          self.log.error(util.format('[%s] Failed to get available branches: %s', name, err));
        }
        return repository;
      })
      .catch(function() {
        return repository;
      });
  }

}

/**
 * The MediaRepositoryManager manages the media repositories. The repositories
 * can be repositories in the local file system or public remote repositories.
 */
class MediaRepositoryManager extends EventEmitter {

  /**
   * Constructs the MediaRepositoryManager.
   * @constructor
   * @param {ApplicationContext} application_context - The application context.
   */
  constructor(application_context) {
    super();
  }

  /**
   * Sets the dependencies from the application context.
   */
  setDependencies() {

    /// The file system repository manager
    this.filesystemRepositoryManager = this.applicationContext.get('filesystemRepositoryManager');

    /// The file system repository manager
    this.gitRepositoryManager = this.applicationContext.get('gitRepositoryManager');

    /// The Inexor Tree root node
    this.root = this.applicationContext.get('tree');

    /// The Inexor Tree node containing media
    this.mediaNode = this.root.getOrCreateNode('media');

    /// Creating a tree node containing the media repositories
    this.repositoriesNode = this.mediaNode.getOrCreateNode('repositories');

    /// Ensure that the default media path exists
    mkdirp.sync(inexor_path.media_path);

    /// Publish the media paths on the Inexor Tree
    this.pathsNode = this.mediaNode.getOrCreateNode('paths');
    let mediaPaths = inexor_path.getMediaPaths();
    for (let i = 0; i &lt; mediaPaths.length; i++) {
      this.pathsNode.addChild(String(i), 'string', mediaPaths[i]);
    }

    /// The class logger
    this.log = this.applicationContext.get('logManager').getLogger('flex.media.repository.MediaRepositoryManager');

  }

  /**
   * Initialization after the components in the application context have been
   * constructed.
   */
  afterPropertiesSet() {

    /// Print the repository paths
    this.log.debug(util.format('Repository paths:\n%s', this.pathsNode.toJson()));

    /// Scan all media paths
    this.scanAll();

    /// Print the scan result
    this.log.debug(util.format('Repository scan result:\n%s', this.repositoriesNode.toJson()));

    if (!this.exists('user')) {
        // Creates a personal media repository for the current user
        this.filesystemRepositoryManager.createRepository('user', this.getRepositoryPath('user'));
    }

  }

  /**
   * Returns the Inexor Tree node which contains all repository nodes.
   * @function
   * @name MediaRepositoryManager.getRepositoriesNode
   * @return {Node} - The Inexor Tree node which contains all repository nodes.
   */
  getRepositoriesNode() {
    return this.repositoriesNode;
  }

  /**
   * Returns the names of the repositories.
   * @function
   * @name MediaRepositoryManager.getRepositoryNames
   * @return {Array&lt;string>}
   */
  getRepositoryNames() {
    return this.repositoriesNode.getChildNames();
  }

  /**
   * Returns the paths of the repositories.
   * @function
   * @name MediaRepositoryManager.getRepositoryPaths
   * @return {Array&lt;string>}
   */
  getRepositoryPaths() {
    let paths = [];
    for (let child of this.repositoriesNode) {
      paths.push(child.path);
    }
    return paths;
  }

  /**
   * Returns true, if a repository with the given name exists in the Inexor Tree.
   * @function
   * @name MediaRepositoryManager.exists
   * @param {string} name - The name of the media repository
   * @return {bool} True, if a repository with the given name exists in the Inexor Tree.
   */
  exists(name) {
    return this.repositoriesNode.hasChild(name);
  }

  /**
   * Scans the default media path for media repositories.
   * @function
   * @name MediaRepositoryManager.scanAll
   */
  scan() {
    this.filesystemRepositoryManager.scan();
    this.gitRepositoryManager.scan();
  }

  /**
   * Scans all media paths. This includes system wide repositories (for
   * example in /usr/local/share/).
   * @function
   * @name MediaRepositoryManager.scanAll
   */
  scanAll() {
    let mediaPaths = inexor_path.getMediaPaths();
    for (var i = 0; i &lt; mediaPaths.length; i++) {
      this.filesystemRepositoryManager.scan(mediaPaths[i]);
      this.gitRepositoryManager.scan(mediaPaths[i]);
    }
  }

  /**
   * Returns the type of a media repository.
   * @function
   * @name MediaRepositoryManager.getType
   */
  getType(name) {
    return this.repositoriesNode.getChild(name).type;
  }

  /**
   * Updates the media repository with the given name.
   * @function
   * @name MediaRepositoryManager.update
   * @param {string} name - The name of the media repository
   * @param {string} branch_name - The name of the branch
   */
  update(name, branch_name = null) {
    switch (this.getType(name)) {
      case 'fs':
        this.filesystemRepositoryManager.update(name);
        break;
      case 'git':
        this.gitRepositoryManager.update(name, branch_name, false);
        break;
    }
  }

  /**
   * Remove a repository from the Inexor Tree.
   * @function
   * @name MediaRepositoryManager.remove
   * @param {string} name - The name of the media repository
   */
  remove(name) {
    if (this.exists(name)) {
      this.repositoriesNode.removeChild(name);
    }
  }

  /**
   * Returns the default repository path for the given repository name.
   * @function
   * @name MediaRepositoryManager.getRepositoryPath
   * @param {string} name - The name of the media repository
   */
  getRepositoryPath(name) {
    return path.join(inexor_path.media_path, name);
  }

}

module.exports = {
  MediaRepositoryManager: MediaRepositoryManager,
  FilesystemRepositoryManager: FilesystemRepositoryManager,
  GitRepositoryManager: GitRepositoryManager,
  repository_types: repository_types
}
</code></pre>
        </article>
    </section>




</div>

<footer>
    <img class="logo" src="https://raw.githubusercontent.com/inexorgame/artwork/master/logo/logo_rendered.png" style="width: 120px; height: 80px">
    <div class="footer-text">NHN Entertainment. Frontend Development Lab</div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var selectedApi = document.getElementById(id); // do not use jquery selector
        var $selectedApi = $(selectedApi);

        $selectedApi.removeClass('hidden');
        $selectedApi.parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
        showLnbApi();
    </script>

</body>
</html>
